import os
import sys
import numpy
from sklearn.decomposition import PCA
import pickle

'''
chb01;4;3.14836;3.44183;3.04206;2.84867;2.73378;2.82107;2.75302;2.14766;6.37782;45.1768;1.52874;0.662006;0.442417;1.71467;3.21618;3.19754;2.72009;2.42245;2.34662;2.43604;2.38261;1.80412;3.27305;30.7685;-0.199423;-0.0539148;0.369655;1.97669;3.0314;2.94414;2.72566;2.42687;2.45336;2.50168;2.35331;1.80413;2.51793;25.8448;0.843323;0.273672;0.47252;1.59187;2.75187;2.81537;2.73187;2.52107;2.18473;2.23807;2.1829;1.55959;0.667735;20.1032;-0.127174;0.0563477;0.377147;1.73632;3.02167;3.43931;3.14628;2.89984;2.76109;2.92995;2.89585;2.25367;7.2165;50.0373;1.14644;0.340382;0.501522;1.51267;3.00797;3.10644;2.61228;2.50312;2.38261;2.35678;2.38255;1.6318;4.22543;24.6701;0.779602;0.119069;0.392666;1.82435;2.95808;2.99697;2.55817;2.36654;2.1005;2.02274;1.95119;1.29307;-1.163;20.4265;0.00896251;0.22235;0.280985;2.30603;2.94743;2.89652;2.79681;2.57538;2.27657;2.35948;2.35461;1.66652;2.4752;23.0476;0.426096;0.103421;0.396791;1.71172;2.98177;3.31715;3.03428;2.83499;2.7425;2.91186;2.81634;2.23187;5.85585;42.559;1.05658;0.0331048;0.498721;1.52734;2.93235;3.06107;2.75388;2.48873;2.32362;2.33104;2.20893;1.52575;0.173993;20.5344;0.868085;0.199267;0.360455;1.97826;3.02758;2.77461;2.65535;2.25918;2.11909;1.99979;1.91035;1.24458;-2.91629;20.6969;0.742983;-0.426293;0.271073;2.39509;3.09527;3.02937;2.74645;2.5393;2.393;2.17665;2.16515;1.80544;0.189255;25.4157;0.336705;0.196938;0.324003;1.97536;3.18421;3.42836;3.07101;2.75567;2.61023;2.76329;2.6873;2.20126;11.2706;45.2459;1.49623;0.0164988;0.351186;2.01571;3.19911;2.96187;2.78847;2.48588;2.39338;2.39336;2.35399;1.83999;-1.98871;27.8699;0.363296;-0.0313873;0.336543;2.12621;3.03747;2.87923;2.76442;2.43356;2.31868;2.24456;2.34346;1.7623;-3.3196;23.4026;0.266761;-0.181677;0.35702;1.96471;3.07667;2.93395;2.56516;2.52086;2.3996;2.26509;2.20185;1.90129;-2.48626;25.0093;0.615904;-0.176696;0.354269;1.90917;2.99988;3.0935;2.84335;2.40117;2.19599;2.12141;1.96609;1.38366;4.08921;21.9317;0.680358;-0.222289;0.285735;2.24592;2.89662;2.83391;2.8232;2.57628;2.22869;2.14705;1.98765;1.31034;-3.33371;24.3459;0.29519;-0.384551;0.295271;2.05383;3.06527;2.72351;2.64681;2.22753;2.32063;2.4411;2.39094;1.86353;2.9243;22.6809;0.693772;-0.165487;0.457032;1.63503;3.4528;3.29317;2.85253;2.4885;2.38448;2.31658;2.17215;1.66389;10.5678;46.0275;1.18186;0.39657;0.255339;2.61156;2.93648;2.84963;2.66111;2.18297;2.21983;2.27951;2.26313;1.67322;-2.82051;18.1439;1.31542;-0.262064;0.37116;1.96966
chb01;4;2.99964;2.78288;2.64072;2.47267;2.7747;2.90167;2.80603;2.23741;-1.53121;39.2277;1.86854;0.526904;0.578722;1.37503;2.81752;2.80587;2.75258;2.39832;2.63008;2.92904;2.85287;2.14241;0.728022;30.6163;0.525709;0.372344;0.522025;1.46265;2.80787;2.69635;2.73648;2.43134;2.6748;2.96481;2.84948;2.20763;-0.523886;29.4367;0.973357;0.0691951;0.563624;1.34909;2.99343;2.76587;2.61335;2.41774;2.252;2.31973;2.21182;1.64745;1.0741;18.5116;-0.0914119;-0.0863058;0.378514;1.83088;3.06989;2.85707;2.68141;2.67011;2.93073;3.04716;2.94395;2.31242;0.328907;48.4764;1.58478;0.471642;0.612085;1.29272;2.9073;2.7204;2.70555;2.34162;2.49657;2.62448;2.50006;1.71154;0.394154;22.2153;1.00222;0.536411;0.48722;1.53157;2.85067;2.75604;2.57715;2.34888;2.15467;2.18665;2.04875;1.36689;-1.28892;15.8092;-0.279692;0.110136;0.371904;1.8101;2.80656;2.75609;2.603;2.45937;2.23481;2.36582;2.2578;1.80388;0.551358;18.4869;0.349654;-0.00636849;0.436625;1.6161;3.00177;2.71459;2.75221;2.60697;2.85646;2.96834;2.87708;2.27006;-1.23436;42.4735;0.952385;0.188291;0.628309;1.24451;2.79735;2.79172;2.69255;2.50068;2.34271;2.38006;2.28633;1.74661;-0.500229;20.7212;0.772776;0.477406;0.419318;1.71354;2.93196;2.78612;2.71725;2.48839;2.13333;2.12629;1.99478;1.39042;1.39347;19.2334;0.467109;0.15754;0.365759;1.76251;2.77767;2.68794;2.72972;2.49827;2.21509;2.2489;2.16915;1.85035;2.81288;20.9739;0.116355;0.0158754;0.349436;1.87088;3.07857;2.56988;2.64704;2.50825;2.69878;2.82312;2.71866;2.21175;-1.366;36.575;2.13574;0.620854;0.519448;1.46504;2.81662;2.85578;2.56646;2.37048;2.39464;2.48239;2.30404;1.96234;-1.41712;19.0858;0.330149;0.0898374;0.463935;1.58327;2.8116;2.54576;2.76635;2.35939;2.37868;2.5805;2.3941;1.91892;2.01351;18.0837;-0.0542084;0.0993123;0.477386;1.53995;2.96061;2.8892;2.70492;2.53294;2.31227;2.35964;2.24638;1.93897;3.27686;23.4;0.505842;-0.375389;0.372296;1.82417;3.01932;2.83254;2.62095;2.3349;2.20774;2.11333;1.99965;1.4048;0.619277;21.0193;-0.0877853;0.0165576;0.312149;2.07697;2.86624;2.91413;2.84391;2.50815;2.25624;2.17095;1.93991;1.43502;1.36752;22.3964;1.45418;0.506977;0.384249;1.64935;2.86782;2.72316;2.46714;2.32409;2.64961;2.91051;2.85588;2.1909;-0.782585;26.8155;1.00717;-0.347738;0.572984;1.32877;3.08165;2.8234;2.72608;2.29379;2.42459;2.33992;2.23655;1.6028;-1.36905;30.8803;1.95554;0.688828;0.353782;2.02268;2.84544;2.83427;2.51449;2.23891;2.31105;2.47367;2.33883;1.89795;0.940553;17.1865;1.68799;-0.267229;0.417822;1.7657
chb01;4;3.60158;3.46602;2.77168;2.6103;2.59558;2.9002;2.81223;2.1379;-8.11928;79.6178;4.1175;0.302499;0.248294;2.88314;3.32271;2.9821;2.69326;2.41917;2.5553;2.62344;2.58554;1.97888;-2.77854;43.2993;2.58541;-1.15973;0.351184;2.14362;3.08784;2.85427;2.74654;2.48392;2.59609;2.60066;2.65814;1.96704;-1.64911;32.1537;0.348436;-0.125;0.484317;1.55314;2.9229;2.58556;2.53669;2.37361;2.22529;2.24747;2.2098;1.438;1.79487;18.1971;-0.182724;0.0395557;0.377111;1.80989;3.49501;3.34954;2.63213;2.64641;2.79634;3.03243;2.91317;2.21441;-7.5538;70.5012;3.06655;-0.754043;0.35392;2.17583;2.96649;2.81433;2.56626;2.42503;2.39951;2.48976;2.36295;1.62505;-1.97497;24.2246;0.796491;-0.5728;0.395058;1.88705;2.81887;2.64988;2.5342;2.3896;2.14112;2.03296;1.93796;1.26657;0.206426;14.2501;-0.234058;0.265327;0.389048;1.72522;2.83304;2.63717;2.62228;2.36073;2.22321;2.2244;2.20409;1.47318;-1.21795;17.1695;0.51749;-0.0820631;0.396196;1.7483;3.39797;3.25399;2.7768;2.7049;2.80737;2.8876;2.83493;2.26188;-5.87912;58.6801;2.4612;-0.352847;0.386043;1.94591;2.95837;2.87032;2.67604;2.44495;2.38268;2.36347;2.25546;1.64105;-2.95215;24.5044;0.544526;0.272035;0.356541;1.96288;2.92389;2.75407;2.78552;2.48651;2.34345;2.1999;2.09009;1.29065;1.47169;20.4331;0.107222;0.190895;0.365626;1.83233;2.93948;3.02941;2.56331;2.40678;2.32514;2.2736;2.22962;1.78546;-0.518544;25.0829;0.431033;-0.436489;0.308535;2.13364;3.46193;3.19626;2.83791;2.61436;2.71148;2.7633;2.65016;2.19559;-9.2716;61.6993;5.55708;-1.98621;0.28621;2.51749;3.3952;3.25956;2.70401;2.48006;2.35673;2.43904;2.46289;1.84821;-0.924145;47.2318;4.7227;1.58979;0.230162;2.89202;3.06474;2.77527;2.72215;2.35173;2.3263;2.34313;2.41024;1.77601;2.32257;26.0044;0.928048;0.345686;0.351864;2.06177;3.10612;2.95416;2.75371;2.43981;2.44089;2.32834;2.27939;1.89126;-0.245345;29.131;0.0264481;-0.427558;0.324888;2.11181;2.98022;2.92044;2.70408;2.37306;2.22896;2.17234;2.01445;1.34619;-3.55617;21.6241;-0.413688;0.116697;0.298748;2.1482;2.91898;2.76068;2.90238;2.64571;2.39097;2.35565;2.06332;1.45212;-0.283883;22.6072;1.58006;0.522667;0.393452;1.70178;3.03606;2.8372;2.55663;2.39451;2.50708;2.59422;2.62055;2.00789;-2.10089;29.7624;0.604505;0.123697;0.493203;1.52797;3.68237;3.3053;2.7579;2.45008;2.46693;2.30822;2.22047;1.57158;-4.89774;82.6983;5.90254;-1.93582;0.154548;4.16118;3.30416;2.91488;2.64011;2.28188;2.35812;2.34125;2.36612;1.72321;5.34455;36.7338;4.0863;1.85272;0.239148;2.93551
chb01;4;3.69186;3.409;2.9464;2.55532;2.31942;2.39546;2.29021;1.64349;-0.486111;93.1283;2.97872;0.512489;0.201702;2.93331;3.40966;3.01343;2.74476;2.31411;2.41134;2.42058;2.46957;1.85689;1.53159;59.6946;5.77624;1.21073;0.193946;3.44832;3.05452;2.77361;2.66118;2.40485;2.44968;2.47415;2.40977;1.81647;1.56021;27.6496;0.851581;-0.16626;0.413359;1.83528;2.80738;2.81745;2.65761;2.48153;2.21052;2.27359;2.21126;1.61677;0.327381;17.0696;0.333982;0.19923;0.419571;1.66709;3.61624;3.3374;2.95223;2.61833;2.37287;2.44401;2.35899;1.714;1.9826;91.8663;6.76144;1.19397;0.242347;2.78409;3.03224;2.87578;2.78691;2.31597;2.18596;2.12978;2.18323;1.46852;0.76656;29.0714;5.04442;0.914553;0.290666;2.34824;2.64623;2.64177;2.57201;2.26921;2.04562;1.98389;1.88539;1.29803;1.22138;13.8226;1.89689;0.702415;0.365439;1.78708;3.02102;2.83082;2.6155;2.42821;2.1441;2.13613;2.03838;1.44897;-0.889805;19.5388;0.353454;0.139216;0.379986;1.80914;3.52136;3.25584;2.87017;2.58371;2.43513;2.49271;2.42533;1.90255;-0.714667;68.6351;4.6548;0.764896;0.251284;2.63346;3.14272;2.90297;2.67244;2.33008;2.1748;2.13813;1.99461;1.47871;-0.314026;24.1258;0.51715;-0.0566474;0.304732;2.25143;2.801;2.59669;2.75116;2.21073;2.07479;2.063;1.79648;1.27094;-1.22215;16.101;0.711742;-0.140665;0.37278;1.85321;3.13978;2.88147;2.81505;2.4378;2.05399;2.152;2.10931;1.85543;-2.62401;26.4684;0.199255;-0.437197;0.306681;2.1385;3.62307;3.24109;3.03523;2.60178;2.39017;2.42421;2.37873;1.95735;2.03602;92.0077;8.06765;1.36062;0.175523;3.18561;3.44946;3.1665;2.67156;2.47142;2.45489;2.49884;2.50706;1.9408;-2.04327;54.8321;3.12769;0.472341;0.211785;3.12706;3.17665;2.79371;2.88367;2.38106;2.37541;2.4397;2.47346;1.81996;-2.31914;30.092;1.59282;-0.222455;0.311638;2.29974;3.17868;2.96854;2.88932;2.39512;2.21953;2.29026;2.22611;1.9723;-2.64576;28.5519;0.0967801;-0.371317;0.338869;2.02927;2.99544;2.82066;2.73862;2.35309;2.05113;2.05832;1.89192;1.28415;0.262897;21.8106;1.78583;0.648317;0.283314;2.13103;2.98845;2.66376;2.83635;2.39484;2.18198;2.16109;1.88591;1.26923;-1.15118;19.4153;-0.0670882;-0.117804;0.375993;1.74189;3.05969;2.81548;2.70384;2.27581;2.37662;2.37611;2.48476;1.89724;-0.131258;26.9069;0.835222;0.130265;0.3616;2.03883;3.77051;3.33198;2.93199;2.58407;2.48647;2.43947;2.34535;1.73046;7.3054;113.832;3.89642;0.27497;0.134199;4.2476;3.38422;2.9488;2.77489;2.36558;2.35088;2.42115;2.40947;1.76134;-1.84982;47.6998;3.53361;0.00186699;0.19092;3.51894
chb01;4;3.66876;3.70731;3.35091;2.72448;2.56795;2.74886;2.60592;2.09883;12.5714;76.6119;3.46951;0.412996;0.300616;2.28445;3.67937;3.44975;3.01544;2.61457;2.39815;2.50759;2.4175;1.86052;2.44124;61.4281;4.76588;1.32703;0.216948;3.00518;3.25007;2.93095;2.77078;2.55683;2.48415;2.81178;2.65521;1.94134;1.78686;35.1044;3.27712;0.544081;0.505315;1.51422;2.81857;2.81032;2.5136;2.53778;2.33533;2.49966;2.49014;1.75609;-3.13416;21.3994;7.7348;-1.43601;0.511281;1.44546;3.67461;3.68063;3.37284;2.84214;2.75329;2.87571;2.73298;2.23825;9.73977;81.7427;9.33083;2.39235;0.385963;1.88633;3.24081;3.06868;2.84845;2.50489;2.41245;2.3634;2.23779;1.69251;3.23871;28.7282;4.85298;1.34519;0.415841;1.75419;2.87754;2.79618;2.59569;2.38097;2.03814;2.10529;1.98284;1.34729;-0.741377;15.8818;1.09988;0.251532;0.343614;1.93209;3.07626;2.86347;2.79322;2.54905;2.28571;2.49861;2.33917;1.79228;1.80823;25.1279;0.188007;-0.0677842;0.372557;1.88981;3.47872;3.54221;3.2031;2.80106;2.69184;2.78399;2.67353;2.07423;7.16613;62.8392;6.74181;1.71424;0.427065;1.69938;3.09917;2.82395;2.66107;2.42757;2.30525;2.18733;2.14689;1.63062;3.11432;23.0204;0.0191948;0.00580836;0.352678;1.97298;2.85999;2.7089;2.66028;2.44372;2.12069;2.07381;1.9863;1.31048;0.560897;16.9711;4.08334;0.646445;0.38069;1.69006;3.95809;3.42927;3.50746;2.83046;2.34569;2.36169;2.34367;2.11519;6.19925;110.275;4.23801;-1.61508;0.144152;3.61579;3.79356;3.67637;3.26723;2.75226;2.48541;2.64212;2.54988;2.06905;9.4578;85.563;9.28221;2.53383;0.242944;2.6482;3.5171;3.30588;2.91403;2.5119;2.42207;2.52204;2.38098;2.00668;1.19048;43.1804;3.42343;-1.30632;0.287629;2.44932;3.2283;2.91815;2.64797;2.58383;2.40267;2.54078;2.43956;1.90671;-1.00237;30.4811;1.42908;-0.465371;0.382632;1.91532;3.99236;3.46992;3.53709;2.88706;2.42281;2.3737;2.34401;2.14903;7.47558;119.357;4.42166;-1.6141;0.151945;3.6204;3.03874;2.89038;2.76673;2.40204;2.07088;1.98603;1.94006;1.40806;2.33631;21.1888;1.88421;0.657929;0.293528;2.12181;2.59319;2.74605;2.75969;2.49854;2.19352;2.06397;1.96264;1.34254;-0.463217;18.6351;0.737568;-0.124561;0.390457;1.68488;3.30538;2.99129;2.57634;2.43362;2.38667;2.47529;2.50377;1.95326;4.25786;29.806;0.463413;-0.324693;0.379171;1.96085;3.94867;3.66388;3.11341;2.75257;2.33342;2.36444;2.23178;1.55634;1.85783;102.824;4.93399;1.39697;0.148926;3.62713;3.52141;3.23541;2.76802;2.40272;2.35299;2.49945;2.33719;1.9145;-7.50801;40.7457;3.7132;-1.4188;0.258313;2.76148
chb01;4;3.42426;3.40322;3.14633;2.7562;2.80593;3.07547;2.94008;2.34926;2.8766;83.605;4.42167;1.05771;0.337706;2.14702;3.21303;3.0403;2.8551;2.64509;2.59413;2.70817;2.7728;2.05213;-1.94788;49.0478;1.21281;-0.101505;0.309758;2.25427;3.17075;2.89902;2.65111;2.58426;2.82552;2.83322;2.84706;2.27146;-1.29655;36.7813;2.62312;0.499179;0.522625;1.46258;3.01366;2.69083;2.61928;2.55555;2.52224;2.63748;2.59936;2.09151;-1.21986;22.8968;5.90767;-1.31116;0.487143;1.51081;3.31378;3.33376;3.06045;2.8343;2.9896;3.24174;3.11447;2.48773;0.873016;77.894;3.69753;1.10095;0.492803;1.54883;2.94241;2.82523;2.69539;2.5056;2.55703;2.77139;2.63824;1.96806;-2.68353;25.8029;1.04279;0.429979;0.523498;1.45382;2.90054;2.72778;2.51206;2.27153;2.0937;2.1381;2.06981;1.45395;0.517018;15.1753;0.0598631;-0.198952;0.363812;1.89393;3.16902;2.9656;2.68984;2.50678;2.39528;2.38977;2.3556;1.79746;0.106456;27.228;0.0296206;0.011424;0.332765;2.07582;3.28893;3.20792;2.97366;2.85127;3.02416;3.11461;3.12176;2.4242;2.77969;69.197;5.16263;1.1247;0.539871;1.43132;3.07891;2.88375;2.75564;2.55372;2.48476;2.51282;2.4662;1.9336;-0.0976801;29.3772;2.9322;0.97862;0.360176;1.99112;2.95212;2.8666;2.76779;2.5727;2.20581;2.24866;2.13676;1.39898;1.43773;18.4411;2.74748;0.627377;0.409841;1.59598;3.69512;3.14801;2.91941;2.78827;2.61113;2.60588;2.38613;2.03501;4.1102;111.213;3.88714;-1.5162;0.160976;3.58796;3.3771;3.18209;3.04086;2.77983;2.84698;2.96145;2.98343;2.30388;-0.756258;65.0829;2.59514;0.755634;0.407405;1.83295;3.28473;3.19239;2.92759;2.67919;2.53051;2.66533;2.66197;2.17366;2.30121;46.3122;2.8238;0.636879;0.31088;2.16824;3.11504;2.70302;2.73654;2.42148;2.50293;2.68707;2.61895;2.10565;0.255647;28.5493;0.267213;0.114945;0.413564;1.80936;3.70547;3.17534;2.93649;2.72721;2.67118;2.65697;2.40308;2.12841;6.28396;119.751;4.26206;-1.56813;0.16128;3.58621;3.05056;2.90302;2.81945;2.44439;2.24997;2.30169;2.14687;1.47655;-0.726877;24.0469;2.16091;0.372786;0.308427;2.07445;3.0298;2.97551;2.83339;2.5513;2.34288;2.27942;2.08045;1.57171;0.567766;20.1714;0.460777;-0.0405258;0.382187;1.72385;3.1324;2.94543;2.63246;2.56221;2.64973;2.64194;2.702;2.15383;1.29617;32.5603;0.386046;-0.309251;0.42476;1.76499;3.47894;3.10898;2.97673;2.65504;2.37793;2.43548;2.24421;1.62024;-6.75404;75.9455;2.38239;-0.443277;0.18777;3.06915;3.21561;2.77739;2.58662;2.35563;2.35461;2.67303;2.56414;2.05063;2.03907;31.9077;0.641028;-0.324841;0.34494;2.15873
chb01;4;3.45935;3.42674;3.12822;2.63482;2.84273;2.97496;2.87102;2.26871;-4.28037;67.3241;12.3188;2.34889;0.400653;1.88313;3.18362;2.85161;2.81214;2.47783;2.55301;2.67951;2.72019;2.11857;1.6453;35.0952;0.9779;0.696832;0.459261;1.61225;2.78678;2.91933;2.65957;2.39749;2.60098;2.71019;2.74165;2.0701;0.496413;29.8599;0.518532;-0.00232109;0.541718;1.40063;2.81575;2.64462;2.56687;2.44067;2.2988;2.31606;2.18249;1.62676;3.30357;17.039;0.170509;-0.251052;0.417374;1.69789;3.38943;3.36103;3.05688;2.68223;2.9687;3.08479;2.98459;2.36265;-1.99939;68.5651;6.15941;1.24138;0.508552;1.55098;2.8914;2.87192;2.68952;2.33379;2.50404;2.47624;2.42853;1.79005;-0.760836;22.9877;0.425093;0.260382;0.476965;1.60601;2.71334;2.58595;2.49903;2.31852;2.18842;2.08431;1.9887;1.42542;3.01854;13.2117;0.21929;0.160519;0.420664;1.66762;2.87329;2.70465;2.68247;2.39933;2.16919;2.25302;2.09249;1.56759;1.10081;22.4829;0.379071;-7.7222e-05;0.322657;2.02387;3.30488;3.23053;2.96644;2.70335;2.95808;3.11421;2.94879;2.21302;-1.56784;61.8043;6.66857;1.15858;0.579044;1.37575;3.04652;2.99508;2.7619;2.46358;2.37496;2.508;2.32483;1.66837;0.0652473;26.0293;5.54197;1.23251;0.396439;1.85027;2.71928;2.53596;2.53203;2.48219;2.19124;2.15423;2.0507;1.32835;0.615842;16.265;1.11664;0.0491483;0.422152;1.61211;3.02662;2.84773;2.95851;2.64346;2.52624;2.61632;2.36353;1.899;-1.29006;29.1246;1.81161;0.511303;0.456576;1.57257;3.28996;3.13489;2.89937;2.61291;2.81595;2.98946;2.81184;2.1996;-1.48924;50.593;3.29544;0.681069;0.513163;1.52748;3.24345;3.11232;2.79554;2.50251;2.52833;2.53926;2.48922;1.99841;0.651709;38.8243;7.11676;1.24236;0.332988;2.05221;2.95836;2.76758;2.57914;2.39315;2.37051;2.47023;2.47163;1.88058;1.2065;23.0285;-0.120977;-0.0293117;0.441855;1.70449;3.07993;2.95325;3.01583;2.68481;2.56265;2.65097;2.33639;1.98074;-2.73275;29.0886;1.92545;-0.0809558;0.470531;1.53027;2.93392;2.94888;2.74577;2.36348;2.22599;2.21089;2.08587;1.44253;2.0654;21.4039;4.02463;0.321547;0.337889;1.969;2.70704;2.84527;2.84176;2.45992;2.37322;2.39579;2.30216;1.56716;2.69498;20.3564;0.896956;-0.194465;0.40291;1.62988;2.98645;2.80235;2.50595;2.32203;2.55571;2.65976;2.69167;2.15584;-2.58318;28.3321;1.14396;-0.430478;0.553251;1.36807;3.41674;3.12542;2.88149;2.56598;2.35993;2.38374;2.15149;1.58727;2.11424;43.3913;3.62224;-0.224107;0.275082;2.40807;2.94942;2.58093;2.37075;2.27619;2.43561;2.44674;2.39583;1.80693;3.30205;21.3406;0.634562;0.124333;0.42443;1.8043
chb01;4;2.95441;2.85438;2.59385;2.60904;2.86561;2.89871;2.76241;2.16695;-1.97955;35.7737;0.234996;-0.286051;0.644376;1.23613;2.84924;2.86633;2.70518;2.49526;2.66863;2.79456;2.76023;2.10185;-0.949328;29.4536;0.253482;0.0621338;0.579893;1.34265;2.91399;2.83714;2.79773;2.54231;2.67844;2.80233;2.77834;2.11188;1.41178;31.2679;0.0200028;0.0756679;0.554756;1.39887;2.76286;2.74612;2.61664;2.36215;2.27305;2.26643;2.17096;1.55598;1.47665;15.8726;0.00440918;-0.279054;0.435333;1.69143;2.98409;2.88355;2.87212;2.78769;3.01338;3.05027;2.85024;2.26626;-2.78007;45.6136;0.274482;-0.14954;0.670342;1.19218;2.89675;2.89278;2.64705;2.32783;2.46218;2.51785;2.3619;1.65022;0.769994;20.5171;-0.000809115;0.0704901;0.478899;1.60426;2.7776;2.74371;2.61905;2.38283;2.12873;2.10517;1.89387;1.3022;0.0911935;13.62;0.203758;0.11386;0.409298;1.70071;2.88427;2.83435;2.85409;2.43588;2.22325;2.21893;2.11007;1.50271;2.10012;19.4688;-0.0118321;-0.302452;0.376778;1.79045;2.86575;2.77491;2.78983;2.74997;2.87142;2.94596;2.87357;2.12104;-1.89866;38.9856;1.07353;-0.150375;0.680034;1.17299;2.51564;2.84957;2.59261;2.40172;2.38693;2.34466;2.24852;1.65325;0.489927;16.2158;0.433241;0.269487;0.501078;1.4901;2.78003;2.42769;2.61201;2.21646;2.0662;2.05803;1.82941;1.24187;0.587988;12.9685;0.170233;0.167155;0.402563;1.74461;3.07988;2.72806;2.87718;2.50943;2.19855;2.1219;2.03593;1.85115;-0.329289;25.256;2.46548;0.155723;0.390382;1.77311;2.86926;2.87108;2.70351;2.6105;2.69947;2.78282;2.75311;2.12401;-2.42025;30.6229;0.793044;-0.224183;0.642341;1.22891;2.83541;2.64161;2.47142;2.40311;2.49785;2.51851;2.46507;1.96743;1.68956;20.3098;-0.204608;0.0804107;0.546352;1.416;2.86182;2.8575;2.70394;2.47292;2.46329;2.60838;2.47931;1.84572;2.18407;22.0979;0.0652479;0.0475414;0.481756;1.58511;3.006;2.70096;2.91499;2.45777;2.28913;2.30381;2.12552;1.94864;-2.85524;27.375;2.5665;-0.348462;0.415592;1.71923;2.67898;2.75999;2.64466;2.3134;2.1672;2.05654;1.9383;1.36239;-0.452534;16.6979;0.385882;-0.236767;0.349528;1.96392;2.85229;2.79519;2.75102;2.52466;2.23192;2.1125;1.83938;1.33231;1.18437;20.726;0.577011;-0.166955;0.375438;1.74933;2.56266;2.58185;2.64552;2.36768;2.64064;2.80365;2.75647;2.15922;0.428114;26.725;0.435314;-0.238208;0.603146;1.28708;2.87203;2.88984;2.74244;2.33832;2.36491;2.38818;2.22719;1.55691;-0.853175;20.8672;0.175209;-0.0919576;0.493398;1.52249;2.6107;2.49433;2.51052;2.22054;2.3991;2.47644;2.41296;1.82019;1.40263;15.483;0.762571;0.296461;0.566869;1.36643
chb01;4;3.46911;3.45286;3.26571;2.80765;2.76456;2.85007;2.73829;2.17335;-0.734127;50.9066;11.2828;2.01546;0.445576;1.69976;3.15403;2.94358;2.84132;2.5169;2.69326;2.75053;2.78571;2.10955;-0.638736;28.9518;1.47551;0.487865;0.52699;1.47585;3.03291;2.67219;2.43741;2.54304;2.66386;2.77386;2.75352;2.06584;-0.0225122;28.4641;-0.238877;0.000362454;0.542806;1.43724;2.80434;2.60849;2.73531;2.31676;2.26728;2.25216;2.1032;1.5176;-0.476572;16.0164;0.105557;-0.303549;0.412164;1.74816;3.44904;3.4489;3.21519;2.86031;2.88301;2.93073;2.8453;2.21515;-1.12332;55.0769;6.5047;1.12732;0.516093;1.50199;3.03095;2.90138;2.87729;2.48997;2.34642;2.36841;2.3463;1.79832;0.712378;20.6931;2.68738;0.890558;0.435106;1.69099;2.78754;2.5694;2.48597;2.31941;2.10809;2.07454;1.86771;1.29252;-0.749389;13.8462;-0.195172;-0.0567664;0.385258;1.77794;2.85744;2.85338;2.6763;2.38231;2.1167;2.19743;2.04965;1.45572;-0.580357;20.3131;-0.263267;-0.181279;0.353559;1.94148;3.42441;3.40579;3.1583;2.82146;2.71622;2.8775;2.7635;2.11858;-0.366682;47.1605;8.1658;1.5359;0.45828;1.63506;3.03175;2.62825;2.67952;2.35389;2.35761;2.28901;2.205;1.59374;0.518162;17.5773;1.58521;0.638004;0.413992;1.79293;2.83472;2.69514;2.50667;2.25588;2.06138;2.03274;1.83236;1.25486;-0.843636;13.3737;0.483342;-0.228796;0.363935;1.91814;3.06389;2.80101;2.68389;2.46693;2.07176;2.07604;1.96527;1.80798;-2.28098;23.1459;-0.0530793;-0.0771646;0.284644;2.1128;3.39338;3.36455;3.13454;2.70616;2.55931;2.75244;2.63649;2.12194;-0.100351;40.7864;8.88409;1.64198;0.40772;1.79108;3.09828;2.98256;2.83249;2.40024;2.51237;2.46385;2.4623;1.95622;-0.226267;23.0474;4.59143;1.1947;0.456691;1.66106;3.10482;2.76078;2.56533;2.3672;2.39933;2.46296;2.4397;1.8491;-1.73535;23.4557;0.197862;0.00273437;0.404877;1.88377;2.97742;2.90516;2.6666;2.4294;2.18544;2.24006;2.09595;1.92503;-1.06113;24.8708;0.105679;0.164012;0.318271;2.10095;3.10035;2.74317;2.65662;2.41743;2.09466;2.02051;1.92842;1.24579;-0.157585;18.1353;0.358808;0.00353451;0.305319;2.14234;3.09864;2.90603;2.73499;2.50228;2.11316;1.94809;1.83805;1.23314;0.338446;20.1597;-0.209772;0.244737;0.305988;2.01395;2.77125;2.65932;2.5213;2.36896;2.62461;2.7172;2.78941;2.13762;0.771902;23.0185;0.404818;-0.317704;0.601173;1.30258;2.87013;2.71655;2.61572;2.35149;2.34412;2.34009;2.18843;1.56398;0.210623;19.1544;-0.099405;0.0353731;0.525715;1.41695;2.62736;2.539;2.27361;2.16854;2.39653;2.38779;2.44006;1.80852;0.229701;14.0228;0.860428;0.186502;0.563093;1.3833
chb01;4;2.91265;2.86327;2.58722;2.54752;2.76924;2.71363;2.72785;2.01585;0.726496;49.2717;12.8364;2.20905;0.422348;1.77632;2.71983;2.52105;2.59652;2.39756;2.5584;2.6022;2.60701;2.05096;2.07494;25.7682;2.34409;0.842944;0.499386;1.50662;3.07016;2.79963;2.68655;2.5067;2.57276;2.66103;2.57891;2.07412;0.549832;27.6556;0.395818;-0.279652;0.498689;1.51314;2.83773;2.66391;2.68834;2.33609;2.12596;2.24422;2.12194;1.52768;0.703602;16.549;0.00336063;-0.222093;0.364973;1.82633;2.92897;2.86244;2.76083;2.72399;2.88763;2.81904;2.81152;2.12464;-0.0248016;52.8009;7.74502;1.30168;0.489543;1.57282;3.03815;2.67885;2.60016;2.46626;2.39653;2.47618;2.34091;1.67714;2.76824;24.0386;1.24112;0.686334;0.401491;1.7805;2.73485;2.64705;2.71879;2.273;2.01432;2.05936;1.94593;1.33251;0.671932;15.3069;-0.122095;0.1536;0.361296;1.82494;3.04322;2.81303;2.78527;2.30904;2.1361;2.22322;2.02419;1.53468;0.682998;21.9425;-0.207161;-0.217901;0.324067;2.08936;2.90318;2.81375;2.7474;2.59091;2.78849;2.74768;2.67659;2.05248;0.3808;46.5143;8.63968;1.60362;0.441762;1.69355;3.08372;2.82059;2.45969;2.42528;2.3155;2.23696;2.08415;1.54955;2.71558;21.8673;0.226004;0.142955;0.339843;2.06804;2.52826;2.58543;2.65948;2.19728;2.0385;2.00429;1.75323;1.24454;0.41743;13.7334;0.489577;-0.276411;0.371853;1.82303;2.82402;2.88448;2.78532;2.30952;2.10833;2.09595;2.00156;1.74156;-0.42239;22.0318;-0.427553;0.00668024;0.2843;2.1179;2.80105;2.90672;2.52272;2.42854;2.68507;2.64821;2.57277;2.0683;1.54342;40.1605;9.31736;1.66836;0.392801;1.85949;2.94414;2.6207;2.5909;2.40725;2.34964;2.45174;2.35443;1.89482;2.0406;25.0115;2.8275;0.829544;0.395308;1.81249;2.95941;2.89508;2.67056;2.37312;2.35742;2.42035;2.35125;1.77724;0.310211;22.514;0.33926;-0.141078;0.371221;1.95195;2.90125;2.93394;2.81469;2.37965;2.23954;2.27641;2.09288;1.85714;-0.799756;23.1649;0.359186;0.203571;0.350327;1.9243;3.12913;2.74484;2.66594;2.38381;2.18419;2.12165;1.90708;1.2659;2.87088;23.3134;0.321912;-0.403579;0.267429;2.30292;2.70902;2.80218;2.76599;2.46176;2.09115;1.9974;1.79148;1.16752;0.454823;20.019;-0.267774;0.344892;0.301393;1.96371;2.54876;2.45011;2.48281;2.27083;2.52731;2.59285;2.59084;2.10753;-0.382708;20.616;0.500886;-0.399288;0.598011;1.27952;2.88039;2.71234;2.52569;2.38842;2.40205;2.33937;2.14388;1.52173;1.3431;20.9102;0.466082;0.180354;0.469052;1.57833;2.75383;2.57381;2.49869;2.21825;2.31701;2.36598;2.33128;1.71967;0.900107;14.4944;0.337294;-0.121072;0.502362;1.50759
'''

x_mean = x_std = None
with open('models/mean_and_std.pkl', 'rb') as f:
    stats = pickle.load(f)
    f.close()
    x_mean, x_std = stats

if x_mean is not None:
    filename = 'models/pca_095_from_294_scaled.pkl'
else:
    filename = 'models/pca_099_from_294.pkl'

with open(filename, 'rb') as f:
    pca_1 = pickle.load(f)
    f.close()


def extract_line(line):
    parts = line.split(';')
    return parts[0], int(parts[1]), numpy.array([float(x) for x in parts[2:]])

for line in sys.stdin:
    patient, true_label, sample = extract_line(line)
    if x_mean is not None:
        sample = numpy.array(sample)
        sample = sample.reshape(-1, x_mean.shape[0])
        sample = (sample - x_mean) / x_std
        sample = sample.ravel()
    sample = pca_1.transform(sample.reshape(1, -1))
    sample = ";".join("{:g}".format(x) for x in sample.ravel())
    print("%s;%d;%s" % (patient, true_label, sample))
